
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Player Page</title>
</head>
<body>
  <h1 id="title">Waiting for Content...</h1>
  <iframe id="pdfViewer" style="display: none; width: 100%; height: 80vh;"></iframe>
  <video id="videoPlayer" controls style="display: none; width: 100%;"></video>

  <script>
    const ws = new WebSocket('ws://localhost/ws');

    const pdfViewer = document.getElementById('pdfViewer');
    const videoPlayer = document.getElementById('videoPlayer');
    const title = document.getElementById('title');

    ws.onmessage = (event) => {
      const message = JSON.parse(event.data);
      handleAction(message);
    };

    function handleAction({ action, itemId, extra }) {
      if (action === 'playItem') {
        fetch('https://example.com/playlist.json')
          .then(response => response.json())
          .then(data => {
            const item = data.playlist.find(i => i.id === itemId);
            if (item) playItem(item);
          });
      }
    }

    function playItem(item) {
      title.innerText = `Now Playing: ${item.name}`;

      if (item.type === 'pdf') {
        pdfViewer.style.display = 'block';
        videoPlayer.style.display = 'none';
        pdfViewer.src = item.source;
      } else if (item.type === 'video') {
        pdfViewer.style.display = 'none';
        videoPlayer.style.display = 'block';
        videoPlayer.src = item.source;
      }
    }
  </script>
</body>
</html>
